<div class="exams-page">
    <!-- Hero Banner -->
    <div class="hero-banner">
        <div class="container">
            <div class="hero-content">
                <div class="hero-text">
                    <h1 class="hero-title">Exam Dashboard</h1>
                    <p class="hero-subtitle">Manage and track all your exams in one place</p>
                </div>
                <div class="hero-stats">
                    <div class="stat-item">
                        <div class="stat-number">{{getTotalExams()}}</div>
                        <div class="stat-label">Total Exams</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">{{getUpcomingExams()}}</div>
                        <div class="stat-label">Upcoming</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">{{getActiveExams()}}</div>
                        <div class="stat-label">Active Now</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Action Bar -->
        <div class="action-bar">
            <div class="action-left">
                <div class="search-container">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search exams..." class="search-input" [(ngModel)]="searchTerm">
                    </div>
                </div>
            </div>

            <div class="action-right">
                <div class="filter-buttons">
                    <button class="filter-btn" [class.active]="currentFilter === 'all'" (click)="setFilter('all')">
                        All
                    </button>
                    <button class="filter-btn" [class.active]="currentFilter === 'upcoming'"
                        (click)="setFilter('upcoming')">
                        Upcoming
                    </button>
                    <button class="filter-btn" [class.active]="currentFilter === 'active'"
                        (click)="setFilter('active')">
                        Active
                    </button>
                    <button class="filter-btn" [class.active]="currentFilter === 'completed'"
                        (click)="setFilter('completed')">
                        Completed
                    </button>
                </div>

                <a class="btn btn-primary" [routerLink]="[0,'edit']">
                    <i class="fas fa-plus"></i>
                    <span>Create Exam</span>
                </a>
            </div>
        </div>

        <!-- Loading State -->
        <div *ngIf="loading" class="loading-container">
            <div class="loading-spinner">
                <div class="spinner"></div>
                <p>Loading your exams...</p>
            </div>
        </div>

        <!-- Empty State -->
        <div *ngIf="!loading && (!Exams || Exams.length === 0)" class="empty-state">
            <div class="empty-illustration">
                <i class="fas fa-file-alt"></i>
            </div>
            <h3>No Exams Found</h3>
            <p>There are no exams available at the moment. Create your first exam to get started!</p>
            <div class="empty-actions">
                <a class="btn btn-primary" [routerLink]="[0,'edit']">
                    <i class="fas fa-plus"></i>
                    <span>Create Your First Exam</span>
                </a>
                <button class="btn btn-outline" (click)="refreshExams()">
                    <i class="fas fa-refresh"></i>
                    <span>Refresh</span>
                </button>
            </div>
        </div>

        <!-- Exams Grid -->
        <div *ngIf="!loading && Exams && Exams.length > 0" class="exams-grid">
            @for (exam of getFilteredExams(); track exam.id) {
            <div class="exam-card">
                <div class="exam-card-header">
                    <div class="exam-status" [class]="getExamStatus(exam)">
                        <span class="status-dot"></span>
                        {{getExamStatusText(exam)}}
                    </div>
                    <div class="exam-actions">
                        <button class="action-btn" (click)="toggleExamMenu(exam.id)" title="More options">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                        <div class="dropdown-menu" [class.show]="activeMenu === exam.id">
                            <a class="dropdown-item" [routerLink]="[exam.id]">
                                <i class="fas fa-eye"></i>
                                <span>View Details</span>
                            </a>
                            <a class="dropdown-item" [routerLink]="[exam.id,'edit']">
                                <i class="fas fa-edit"></i>
                                <span>Edit Exam</span>
                            </a>
                            <a class="dropdown-item" [routerLink]="[exam.id,'take']">
                                <i class="fas fa-play"></i>
                                <span>Take Exam</span>
                            </a>
                            <button class="dropdown-item text-danger" (click)="deleteExam(exam.id)">
                                <i class="fas fa-trash"></i>
                                <span>Delete</span>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="exam-card-body">
                    <h3 class="exam-title">{{exam.title}}</h3>

                    <div class="exam-details">
                        <div class="detail-item">
                            <i class="fas fa-book"></i>
                            <span>Course ID: {{exam.courseId}}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-trophy"></i>
                            <span>Max Score: {{exam.maxDegree}} points</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-target"></i>
                            <span>Min Score: {{exam.minDegree}} points</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-calendar"></i>
                            <span>Start: {{formatDate(exam.startDate)}}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-calendar-check"></i>
                            <span>End: {{formatDate(exam.endDate)}}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-clock"></i>
                            <span>Duration: {{exam.duration}} minutes</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-user-tie"></i>
                            <span>Teacher ID: {{exam.teacherId}}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-question-circle"></i>
                            <span>Questions: {{exam.questions?.length || 0}}</span>
                        </div>
                    </div>


                </div>

                <div class="exam-card-footer">
                    <div class="exam-actions-footer">
                        <a class="btn btn-outline btn-sm" [routerLink]="[exam.id]">
                            <i class="fas fa-eye"></i>
                            <span>View</span>
                        </a>
                        <a class="btn btn-primary btn-sm" [routerLink]="[exam.id,'take']">
                            <i class="fas fa-play"></i>
                            <span>Take</span>
                        </a>
                    </div>
                </div>
            </div>
            }
        </div>

        <!-- Pagination -->
        <div *ngIf="!loading && Exams && Exams.length > 0" class="pagination-container">
            <div class="pagination-info">
                <span>Showing {{getPaginationInfo().start}} to {{getPaginationInfo().end}} of
                    {{getPaginationInfo().total}} exams</span>
            </div>

            <div class="pagination-controls">
                <button class="btn btn-outline btn-sm" [disabled]="currentPage === 1" (click)="previousPage()">
                    <i class="fas fa-chevron-left"></i>
                    <span>Previous</span>
                </button>

                <div class="page-numbers">
                    <button class="page-btn" [class.active]="page === currentPage" *ngFor="let page of getPageNumbers()"
                        (click)="goToPage(page)">
                        {{page}}
                    </button>
                </div>

                <button class="btn btn-outline btn-sm" [disabled]="currentPage === totalPages" (click)="nextPage()">
                    <span>Next</span>
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>
</div>