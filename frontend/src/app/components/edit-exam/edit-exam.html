<p>edit-exam works!</p>
<div class="container py-4">
    <div class="card shadow-lg">
        <div class="card-header bg-primary text-white">
            <h2 class="mb-0">@if(examId=='0'){ Add Exam }@else { Edit Exam }</h2>
        </div>
        <div class="card-body">
            <form [formGroup]="examForm" (ngSubmit)="handel_Edit_Add_Exam(examForm)">
                <input formControlName="id" type="hidden" id="examId">
                <div *ngIf="examId !== '0'" class="mb-3">
                    <label for="exampleInputId" class="form-label">Exam ID</label>
                    <input formControlName="id" type="text" class="form-control" id="exampleInputId" readonly>
                </div>
                <div class="row g-3">
                    <div class="col-md-6">
                        <label for="exampleInputTitle" class="form-label">Title</label>
                        <input formControlName="title" type="text" class="form-control" id="exampleInputTitle"
                            aria-describedby="TitleHelp">
                        <div *ngIf="(getTitle.touched || formSubmitted) && getTitle.invalid"
                            class="text-danger form-text">
                            <div *ngIf="getTitle.errors?.['required']">The Title field is required.</div>
                            <div *ngIf="getTitle.errors?.['minlength']">Title must be at least 3 characters long.</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <label for="exampleInputMaxDegree" class="form-label">Max Degree</label>
                        <input formControlName="maxDegree" type="number" class="form-control"
                            id="exampleInputMaxDegree">
                        <div *ngIf="(getMaxDegree.touched || formSubmitted) && getMaxDegree.invalid"
                            class="text-danger form-text">
                            <div *ngIf="getMaxDegree.errors?.['required']">Required</div>
                            <div *ngIf="getMaxDegree.errors?.['min']">Min is 1</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <label for="exampleInputMinDegree" class="form-label">Min Degree</label>
                        <input formControlName="minDegree" type="number" class="form-control"
                            id="exampleInputMinDegree">
                        <div *ngIf="(getMinDegree.touched || formSubmitted) && getMinDegree.invalid"
                            class="text-danger form-text">
                            <div *ngIf="getMinDegree.errors?.['min']">Min is 0</div>
                        </div>
                    </div>
                </div>
                <div class="row g-3 mt-2">
                    <div class="col-md-6">
                        <label for="exampleInputStartDate" class="form-label">Start Date</label>
                        <input formControlName="startDate" type="datetime-local" class="form-control"
                            id="exampleInputStartDate">
                        <div *ngIf="(getStartDate.touched || formSubmitted) && getStartDate.invalid"
                            class="text-danger form-text">
                            <div *ngIf="getStartDate.errors?.['required']">Required</div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label for="exampleInputDuration" class="form-label">Duration (hours)</label>
                        <input formControlName="duration" type="number" class="form-control" id="exampleInputDuration">
                        <div *ngIf="(getDuration.touched || formSubmitted) && getDuration.invalid"
                            class="text-danger form-text">
                            <div *ngIf="getDuration.errors?.['required']">Required</div>
                        </div>
                    </div>
                </div>
                <hr class="my-4">
                <h4 class="mb-3">Questions</h4>
                <div formArrayName="questions">
                    <div *ngFor="let question of questions.controls; let qIndex = index" [formGroupName]="qIndex"
                        class="card mb-4 border-primary">
                        <div class="card-header bg-light d-flex justify-content-between align-items-center">
                            <span>Question {{qIndex + 1}}</span>
                            <button type="button" (click)="removeQuestion(qIndex)" class="btn btn-outline-danger btn-sm"
                                title="Remove Question">
                                <i class="bi bi-trash"></i> Remove
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="row g-2 align-items-end">
                                <div class="col-md-8">
                                    <label class="form-label">Question Text</label>
                                    <input formControlName="title" placeholder="Question text"
                                        class="form-control mb-2" />
                                    <div *ngIf="(question.get('title')?.touched || formSubmitted) && question.get('title')?.invalid"
                                        class="text-danger form-text">
                                        <div *ngIf="question.get('title')?.errors?.['required']">
                                            Question text is required.</div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Degree</label>
                                    <input formControlName="degree" type="number" placeholder="Degree"
                                        class="form-control mb-2" />
                                    <div *ngIf="(question.get('degree')?.touched || formSubmitted) && question.get('degree')?.invalid"
                                        class="text-danger form-text">
                                        <div *ngIf="question.get('degree')?.errors?.['required']">Degree is required.
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-3">
                                <h6>Options</h6>
                                <div formArrayName="options">
                                    <div *ngFor="let option of getOptions(qIndex).controls; let oIndex = index"
                                        [formGroupName]="oIndex" class="row g-2 align-items-center mb-2">
                                        <div class="col-md-7">
                                            <input formControlName="title" placeholder="Option text"
                                                class="form-control" />
                                            <div *ngIf="(option?.get('title')?.touched || formSubmitted) && option?.get('title')?.invalid"
                                                class="text-danger form-text">
                                                <div *ngIf="option?.get('title')?.errors?.['required']">Option text is
                                                    required.</div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-check">
                                                <input type="checkbox" formControlName="isCorrect"
                                                    class="form-check-input" id="isCorrect{{qIndex}}{{oIndex}}" />
                                                <label class="form-check-label"
                                                    for="isCorrect{{qIndex}}{{oIndex}}">Correct</label>
                                            </div>
                                        </div>
                                        <div class="col-md-2 text-end">
                                            <button type="button" (click)="removeOption(qIndex, oIndex)"
                                                class="btn btn-outline-warning btn-sm" title="Remove Option">
                                                <i class="bi bi-x-circle"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <button type="button" (click)="addOption(qIndex)"
                                        class="btn btn-outline-secondary btn-sm mt-1">
                                        <i class="bi bi-plus-circle"></i> Add Option
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="button" (click)="addQuestion()" class="btn btn-outline-primary mt-2">
                        <i class="bi bi-plus-circle"></i> Add Question
                    </button>
                </div>
                <div class="d-flex justify-content-end mt-4">
                    <button type="submit" class="btn btn-success btn-lg px-4">Submit</button>
                </div>
            </form>
        </div>
    </div>
</div>
<p>{{examForm.value | json}}</p>